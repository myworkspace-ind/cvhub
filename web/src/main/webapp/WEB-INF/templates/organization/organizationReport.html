<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Organization Report</title>
    <th:block th:include="fragments/head"></th:block>
</head>
<body>
    <th:block th:include="fragments/hmenu"></th:block>
	<div class="container">
        <h2 class="text-center" >Organization Report</h2>
                <!-- Tìm kiếm theo tên công ty -->
		<form method="get" action="/cvhub-web/searchOrganization"
			class="form-inline d-flex align-items-center">
			<label for="companyName" class="mr-2 mb-0">Filter by Company Name:</label> 
			<input type="text" id="companyName" maxlength="254" name="companyName" style="width: 200px;" placeholder="Company Name" class="form-control" th:value="${name}"> 
			<label for="location" class="mr-2 ml-3 mb-0"> Location:</label>
			 <select name="location" id="locationSelect" class="option-item-sort form-select" onchange="searchJobs(0)" style="width: 400px;" th:value="${location}">
				<option value="0">Tất cả tỉnh/thành phố</option>
			</select>

			<button type="submit" class="btn btn-primary ml-3">Apply</button>
		</form>

		<script type="text/javascript"
			th:src="@{/resources/main/searchlocation.js}"></script>
	</div>
<div class="card container">
		
		<div class="table-responsive mt-4 card-header bg-transparent px-0 pt-0 pb-7">
		<table id="organizationTable" class="table table-striped table-hover table-bordered">
			<thead style="background-color: #004085; color: white;">
				<tr>
					<th>STT</th>
					<th>Logo</th>
					<th>Company Name</th>
					<th>Location</th>
					<th>Created Date</th>
					<th>Details</th>
					<th>Job Count</th>
					<th>Organization Page</th> 
					<th>WebSite</th>
				</tr>
			</thead>
			<tbody id="organizationTableBody">
				<!-- Kiểm tra nếu organizations có dữ liệu -->
				<tr th:each="organization, iterStat : ${organizations}">
					<td th:text="${iterStat.index + 1}"></td>
					<!-- Hiển thị STT -->
					<td><img
						th:src="@{/images/{logoId}(logoId=${organization.logoID})}"
						alt="Company logo" style="width: 50px; height: 50px;"></td>
					<td th:text="${organization.title}"></td>
					<!-- Hiển thị tên công ty -->
					<td th:text="${organization.location}"></td>
					<!-- Hiển thị vị trí -->
					<td
						th:text="${#dates.format(organization.createdDate, 'dd/MM/yyyy')}"></td>
					<!-- Hiển thị ngày tạo -->
					<td th:text="${organization.detail}"></td>
					<td th:text="${jobCount[organization.id]}"></td> 
					<td>
						<a th:href="@{/main/organization/{id}(id=${organization.id})}">
		                  <button class="btn btn-primary btn-sm text-nowrap p-2">View Page</button>
		                </a>
                	</td>
					<!-- Hiển thị chi tiết -->
					<td><a th:href="${organization.website}" target="_blank">
							<button class="btn btn-primary btn-sm text-nowrap p-2 ">View Website</button>
					</a></td> 
					<!-- Hiển thị Website -->
				</tr>
				<!-- Hiển thị thông báo nếu không có tổ chức nào -->
				<tr th:if="${#lists.isEmpty(organizations)}">
					<td colspan="7"
						th:text="'No organizations found for the selected period.'"></td>
				</tr>
			</tbody>
		</table>
		
		<nav aria-label="Page navigation" class="mt-5">
        <ul class="pagination justify-content-center">
            <!-- Previous button -->
            <li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
                <a class="page-link" th:href="${currentPage > 0} ? @{/main/report/organization(page=${currentPage - 1}, size=${size})} : '#'" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            <!-- Page numbers -->
            <li class="page-item" th:each="pageNum : ${#numbers.sequence(0, totalPages - 1)}" th:classappend="${pageNum == currentPage} ? 'active'">
                <a class="page-link" th:href="@{/main/report/organization(page=${pageNum}, size=${size})}" th:text="${pageNum + 1}"></a>
            </li>

            <!-- Next button -->
            <li class="page-item" th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
                <a class="page-link" th:href="${currentPage < totalPages - 1} ? @{/main/report/organization(page=${currentPage + 1}, size=${size})} : '#'" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>
    </nav>
	</div>
</div>
	
	<!--    
    <th:block th:include="fragments/common_javascript"></th:block> -->
</body>
</html>
