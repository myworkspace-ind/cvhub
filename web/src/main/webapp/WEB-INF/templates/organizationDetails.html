<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">

<head>
<meta charset="UTF-8">
<title>Organization Details</title>
<link rel="stylesheet"
	th:href="@{/resources/organizationDetails/style.css}" />
<link rel="stylesheet" th:href="@{/resources/home/style.css}" />
<script type="text/javascript"
	th:src="@{/resources/organizationDetails/organizationDetails.js}"></script>
<style>
.review-container {
	max-width: 600px;
	margin: 20px auto;
	padding: 15px;
	background-color: #f8f8f8;
	border-radius: 5px;
}

.review-header {
	display: flex;
	justify-content: space-between;
	align-items: center;
	margin-bottom: 15px;
}

.star-rating {
	color: #ddd;
	font-size: 24px;
}

.star-rating .filled {
	color: #ffd700;
}

.review-count {
	margin-bottom: 10px;
}

.review-item {
	background-color: #fff;
	padding: 10px;
	margin-bottom: 10px;
	border-radius: 5px;
}

.review-author {
	display: flex;
	align-items: center;
	margin-bottom: 5px;
}

.author-avatar {
	width: 30px;
	height: 30px;
	background-color: #007bff;
	color: #fff;
	border-radius: 50%;
	display: flex;
	justify-content: center;
	align-items: center;
	margin-right: 10px;
}

.review-date {
	font-size: 12px;
	color: #777;
}

.review-text {
	margin-top: 5px;
}

.review-actions {
	margin-top: 10px;
}

.review-actions button {
	background: none;
	border: none;
	cursor: pointer;
	margin-right: 10px;
}

.overlay {
	display: none;
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background-color: rgba(0, 0, 0, 0.5);
	z-index: 1000;
}

.review-form {
	display: none;
	position: fixed;
	top: 50%;
	left: 50%;
	transform: translate(-50%, -50%);
	background-color: white;
	padding: 20px;
	border-radius: 5px;
	width: 80%;
	max-width: 500px;
	z-index: 1001;
}

.star-rating-input {
	display: flex;
	flex-direction: row-reverse;
	justify-content: flex-end;
}

.star-rating-input input {
	display: none;
}

.star-rating-input label {
	cursor: pointer;
	font-size: 30px;
	color: #ddd;
}

.star-rating-input label:before {
	content: '\2605';
}

.star-rating-input input:checked ~ label {
	color: #ffd700;
}
</style>
</head>

<body>
	<div th:replace="~{fragments/header :: header}"></div>
	<div class="container">
		<div class="org-header">
			<div class="org-logo">
				<img th:src="@{/images/{logoId}(logoId=${organization.logoID})}" alt="Company logo">
			</div>
			<div class="org-info">
				<h1 class="org-name" th:text="${organization.title}"></h1>
				<p class="org-details" th:text="${organization.website}"></p>
			</div>
			<!-- Kiểm tra user đã đăng nhập và là chủ của organization này -->
			<div th:if="${isOwner}">
				<button id="toggleJobForm" class="follow-btn">Thêm thông tin tuyển dụng</button>
				<button id="toggleJobForm2" class="follow-btn">Sửa thông tin công ty</button>
			</div>
		</div>

		<div class="content-section">
			<h2 class="section-title">Giới thiệu công ty</h2>
			<p th:text="${organization.summary}"></p>
			<p>Lý do gia nhập công ty:</p>
			<ul>
				<li th:text="${organization.detail}"></li>
			</ul>
		</div>

		<div class="content-section">
			<h2 class="section-title">Tuyển dụng</h2>
			<ul class="job-list">
				<li th:each="job : ${jobByOrganization}" class="job-item">
					<div>
						<div class="job-title" th:text="${job.title}"></div>
						<div class="job-location" th:text="${job.location.name}"></div>
						<div class="job-date" th:text="${job.createdDate}"></div>
					</div>
					<form th:action="@{/jobrequests/{id}(id=${job.id})}" method="get" style="display: inline;">
						<button type="submit" class="apply-btn">Chi Tiết</button>
					</form>

				</li>
			</ul>
		</div>

		<div class="content-section">
			<h2 class="section-title">Thông tin liên hệ</h2>
			<div class="contact-info">
				<div>
					<p><strong>Địa chỉ công ty:</strong></p>
					<p th:text="${organization.location}"></p>
				</div>
			</div>
		</div>
		<div class="content-section">
			<h2 class="section-title">Review</h2>
			<div class="container review-container" th:each="review : ${reviews}">
				<div class="review-header">
					<button id="openReviewForm" class="btn btn-primary"
						th:text="'Viết Review công ty ' + ${organization.title}"></button>
				</div>

				<div class="review-count">
					<span th:text="${reviewCount}"></span> bình luận
					<div class="pull-right">
						<select id="sortCombobox" class="form-control custom-select">
							<option value="newest">Mới nhất</option>
							<option value="oldest">Cũ nhất</option>
							<option value="highest">Đánh giá cao nhất</option>
							<option value="lowest">Đánh giá thấp nhất</option>
						</select>
					</div>
				</div>

				<div class="review-item">
					<div class="review-author">
						<div class="author-avatar">A</div>
						<strong>Ẩn danh</strong> <span class="review-date pull-right">9
							phút trước</span>
					</div>
					<div class="star-rating">
						<th:block th:each="star : ${#numbers.sequence(1, 5)}">
							<span th:class="${star <= review.rating} ? 'filled' : ''">★</span>
						</th:block>
					</div>
					<p class="review-text" th:text="${review.reviewText}"></p>
				</div>

				<div class="comment-actions">
					<button id="openReplyForm" class="comment-action reply-button">Trả
						lời</button>
				</div>
			</div>
		</div>

	</div>

	<div class="overlay" id="formOverlay"></div>
	<div id="jobPostForm">
		<h3>Thêm thông tin tuyển dụng</h3>
		<form id="requirementsForm" th:action="@{/jobrequests/registerJob}" method="post">
			<input type="hidden" id="organizationId" name="organizationId" th:value="${organization.id}">

			<div class="form-group">
				<label for="namejob">Tên công việc cần tuyển dụng*</label>
				<input type="text" class="form-control" id="namejob" name="title" required>
			</div>

			<div class="form-group">
				<label for="industry">Mảng ngành nghề</label>
				<select class="form-control" id="jobRoleId" name="jobRoleId" required>
					<option selected disabled>Chọn Ngành Nghề Tuyển Dụng</option>
					<option th:each="alLJobRole : ${alLJobRole}" th:value="${alLJobRole.id}"
						th:text="${alLJobRole.title}"></option>
				</select>
			</div>
			<div class="form-group">
				<label for="locationCode">Địa điểm làm việc*</label>
				<select class="form-control" id="locationCode" name="locationCode" required>
					<option selected disabled>Chọn địa điểm</option>
					<option th:each="location : ${locations}" th:value="${location.code}" th:text="${location.name}">
					</option>
				</select>
			</div>
			<div class="form-group">
				<label for="experience">Yêu cầu kinh nghiệm*</label>
				<input type="number" class="form-control" id="experience" name="experience" min="0" required
					placeholder="Nhập số năm kinh nghiệm">
				<small class="form-text text-muted">Nhập số năm kinh nghiệm (0 hoặc nhiều hơn).</small>
			</div>

			<div class="form-group">
				<label for="salary">Lương Cơ bản ($) *</label>
				<select class="form-control" id="salaryOption" name="salaryOption" required
					onchange="toggleSalaryInput()">
					<option value="0">Thỏa thuận</option>
					<option value="1">Nhập lương</option>
				</select>
				<input type="number" class="form-control mt-2" id="salary" name="salary" required style="display: none;"
					placeholder="Nhập lương" min="0">

				<div class="form-group">
					<label for="detailsJob">Chi tiết công việc*</label>
					<textarea id="jobDescription" name="jobDescription" required
						placeholder="Nhập chi tiết công việc (mỗi dòng là một gạch đầu dòng)"></textarea>
				</div>
				<div class="form-group">
					<label for="requirementsCandidate">Yêu cầu ứng viên*</label>
					<textarea id="requirementsCandidate" name="requirementsCandidate" required
						placeholder="Nhập yêu cầu ứng viên (mỗi dòng là một gạch đầu dòng)"></textarea>
				</div>
				<div class="form-group">
					<label for="benefitCandidate">Quyền lợi ứng viên*</label>
					<textarea id="benefitCandidate" name="benefitCandidate" required
						placeholder="Nhập quyền lợi ứng viên (mỗi dòng là một gạch đầu dòng)"></textarea>
				</div>
				<div class="form-group">
					<label for="deadlineApplication">Hạn nộp hồ sơ*</label>
					<input type="date" id="deadlineApplication" name="deadlineApplication" required>
				</div>
			</div>

			<button type="submit" class="btn btn-primary">Lưu</button>
		</form>
	</div>



	<div class="overlay" id="overlay"></div>
	<div class="review-form" id="reviewForm">
		<h2>Viết Review</h2>
		<form>
			<div class="form-group">
				<label>Cho điểm công ty (1 - 5 sao)</label>
				<div class="star-rating-input">
					<input type="radio" id="star5" name="rating" value="5" /><label
						for="star5"></label> <input type="radio" id="star4" name="rating"
						value="4" /><label for="star4"></label> <input type="radio"
						id="star3" name="rating" value="3" /><label for="star3"></label>
					<input type="radio" id="star2" name="rating" value="2" /><label
						for="star2"></label> <input type="radio" id="star1" name="rating"
						value="1" /><label for="star1"></label>
				</div>
			</div>
			<div class="form-group">
				<label for="name">Họ & Tên</label> <input type="text"
					class="form-control" id="name"
					placeholder="Nhập bất kì tên gì mà bạn muốn hoặc bỏ trống">
			</div>
			<div class="form-group">
				<label for="position">Chức vụ / Vị trí công việc</label> <input
					type="text" class="form-control" id="position"
					placeholder="Dev / HR hay Manager">
			</div>
			<div class="form-group">
				<label for="comment">Bình luận của bạn (Bắt buộc)</label>
				<textarea class="form-control" id="comment" rows="5"
					placeholder="Nhập bình luận của bạn về DAIICHI GROUP - DAIICHI TRAVEL"></textarea>
				<small class="text-muted">Nội dung bình luận tối thiểu 10 kí
					tự. Vui lòng không spam!</small>
			</div>
			<div class="form-group">
				<div class="g-recaptcha" data-sitekey="YOUR_RECAPTCHA_SITE_KEY"></div>
			</div>
			<div class="checkbox">
				<label> <input type="checkbox" required> Bằng cách
					bấm vào Đăng review rằng bạn đã đồng ý với <a href="#"
					target="_blank">điều khoản sử dụng</a> của chúng tôi.
				</label>
			</div>
			<button type="button" class="btn btn-default" id="closeReviewForm">Đóng</button>
			<button type="submit" class="btn btn-primary" id="submitReview">Gửi</button>
		</form>
	</div>




	<div class="overlay" id="replyOverlay"></div>
	<div class="reply-form" id="replyForm">
		<h4>Trả lời bình luận</h4>
		<form>
			<div class="form-group">
				<textarea class="form-control" rows="3"
					placeholder="Nhập bình luận của bạn..."></textarea>
			</div>
			<button type="button" class="btn btn-default" id="closeReplyForm">Đóng</button>
			<button type="submit" class="btn btn-primary" id="submitReply">Gửi</button>
		</form>
	</div>



	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://www.google.com/recaptcha/api.js" async defer></script>
	<script>
		$(document).ready(function() {
			$('#openReviewForm').click(function() {
				$('#overlay').show();
				$('#reviewForm').show();
			});

			$('#closeReviewForm').click(function() {
				$('#overlay').hide();
				$('#reviewForm').hide();
			});

			$('#overlay').click(function() {
				$('#overlay').hide();
				$('#reviewForm').hide();
			});

			$('#submitReview').click(function(e) {
				e.preventDefault();
				// Xử lý gửi form ở đây
				alert('Đã gửi review thành công!');
				$('#overlay').hide();
				$('#reviewForm').hide();
			});
		});
	</script>
	<script>
		$(document).ready(function() {
			$('#openReplyForm').click(function() {
				$('#replyOverlay').show();
				$('#replyForm').show();
			});

			$('#closeReplyForm').click(function() {
				$('#replyOverlay').hide();
				$('#replyForm').hide();
			});

			$('#replyOverlay').click(function() {
				$('#replyOverlay').hide();
				$('#replyForm').hide();
			});

			$('#submitReply').click(function(e) {
				e.preventDefault();
				// Handle reply form submission here
				alert('Đã gửi trả lời thành công!');
				$('#replyOverlay').hide();
				$('#replyForm').hide();
			});
		});
	</script>

</body>

</html>